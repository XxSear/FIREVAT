---
title: "FIREVAT Introduction"
output: html_document
author: Andy Jinseok Lee, Hyunbin Kim
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 00. Using FIREVAT
Using ```RunFIREVAT```, you can perform variant refinement using mutational signatures.<br/>
With 2 cores (each with 3.5GHz clock speed) this sample script akes about 10 minutes to run.
```{r, echo=FALSE}
library(FIREVAT)

# Assign output directory
output.dir <- "/home/jinseoklee/Documents/Projects/Temp/FIREVAT_TEMP/"

sample.vcf.file <- system.file("extdata", "DCC_PCAWG_Cell_Lines_HCC1954.vcf", package = "FIREVAT")
config.file <- system.file("config", "PCAWG_DKFZ_Cell_Line_Filtering_Params.json", package = "FIREVAT")

results <- RunFIREVAT(vcf.file = sample.vcf.file,
                      vcf.file.genome = 'hg19',
                      config.file = config.file,
                      df.ref.mut.sigs = GetPCAWGMutSigs(),
                      target.mut.sigs = GetPCAWGMutSigsNames(),
                      sequencing.artifact.mut.sigs = PCAWG.All.Sequencing.Artifact.Signatures,
                      output.dir = output.dir,
                      objective.fn = Default.Obj.Fn,
                      num.cores = 2,
                      ga.pop.size = 100,
                      ga.max.iter = 5,
                      ga.run = 5,
                      ga.pmutation = 0.1,
                      perform.strand.bias.analysis = TRUE,
                      ref.forward.strand.var = "TumorDPRefForward",
                      ref.reverse.strand.var = "TumorDPRefReverse",
                      alt.forward.strand.var = "TumorDPAltForward",
                      alt.reverse.strand.var = "TumorDPAltReverse",
                      annotate = FALSE)
```

### 00-1. Variant refinement

### 00-2. Manual filtering

### 00-3. Mutational signature analysis

```{r}

```

## 01. Introduction

FIREVAT (FInding REliable Variants without ArTifacts) uses mutational signatures to perform variant refinement and generates accurate signature analysis. 

The R package FIREVAT provides 

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## 02. Installing FIREVAT

## 03. Inputs

### 03-X. Loading example data

### 03-X. Genetic Algorithm (GA) parameters

### 03-X. Objective function
Refer to 04-X. 

### 03-X. Preparing your own VCF file

### 03-X. Preparing your own configuration file

### 03-X. Preparing your own mutational signature reference matrix

### 03-X. Selecting target mutational signatures by cancer type

### 03-X. Mutalisk parameters
Refer to 05-X. Mutalisk parameters

### 03-X. Variant annotation parameters

#### 03-X-Y. Downloading ClinVar, COSMIC etc

#### 03-X-Y. Preparing annotation data.frame


## 04. Variant refinement

### 04-X. Modes

### 04-Y. Optimization parameters






## 05. Mutational signature analysis

### 05-X. Mutalisk

#### 05-X-Y. Mutalisk parameters

#### 05-X-Y. Mutalisk results

### 05-X. MutationalPatterns

#### 05-X-Y. MutationalPatterns parameters

#### 05-X-Y. MutationalPatterns results







## 06. Strand bias analysis

### 06-1. Filtering variants by strand bias analysis results

## 07. Variant annotation

### 07-1. Annotating variants

### 07-2. White/black list

## 08. FIREVAT report

## 09. Generating individual FIREVAT report plots

## 10. Advanced FIREVAT examples

### 10-1. Additional plot generation
Cohort-level signature probability distribution plot
Correlation plot
Sequence logo plot
Bubble chart plot

### 10-2. Custom pipeline

## 11. Session info

Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
